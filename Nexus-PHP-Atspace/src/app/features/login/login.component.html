<section>
    <div class="login">
        <h1>Iniciar sesión</h1>
        <form [formGroup]="form" (submit)="onSubmit()">
            <div>
                <label for="email">Email</label>
                <input name="email" formControlName="email" placeholder="Ej. user@dominio.com">
                @for (msg of errorMessages['email']; track msg) {
                    <span class="errorMessage">{{msg}}</span>
                }
            </div>
            <div>
                <label for="password">Contraseña</label>
                <div class="password-input">
                    <input name="password" [type]="showPassword ? 'text' : 'password'" formControlName="password" placeholder="">
                    <i class="fa-solid" 
                       [class.fa-eye]="!showPassword" 
                       [class.fa-eye-slash]="showPassword"
                       (click)="showPassword = !showPassword">
                    </i>
                </div>
                @for (msg of errorMessages['password']; track msg) {
                    <span class="errorMessage">{{msg}}</span>
                }
            </div>
            @for (msg of errorMessages['credenciales']; track msg) {
                <span class="errorMessage errorMessageGlobal">{{msg}}</span>
            }
            @for (msg of errorMessages['global']; track msg) {
                <span class="errorMessage errorMessageGlobal">{{msg}}</span>
            }
            @if (loginError) {
                <div class="errorMessage errorMessageGlobal">{{loginError}}</div>
            }
            
            <!-- Debug info -->
            <div style="background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; font-size: 12px;">
                <strong>Servidor actual:</strong> {{standaloneAuth.getCurrentUrl()}}<br>
                <button type="button" (click)="toggleServer()" style="margin-top: 5px; padding: 5px 10px;">
                    Cambiar a {{standaloneAuth.getCurrentUrl().includes('localhost') ? 'Ngrok' : 'Local'}}
                </button>
            </div>
            
            <button type="submit">Entrar</button>
        </form>
        
        <div class="google-signin">
            <asl-google-signin-button type="standard" size="large"></asl-google-signin-button>
        </div>
        
        <div class="redirect">
            <span>¿No tienes cuenta?</span><a routerLink="/register" class="link">Crear una</a>
        </div>
    </div>
</section>